<!-- Admin Dashboard Page: Displays all collected form data and allows export/delete actions -->
<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <!-- Import Tailwind CSS for styling -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
  <!-- Page Title -->
  <h2 class="text-2xl font-bold mb-4">Collected Form Data</h2>
  <!-- Export to CSV button -->
  <a href="/export" class="inline-block bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 mb-4">
    ðŸ“¥ Export to CSV
  </a> 
  <!-- Data Table: Shows all users from the database -->
  <table class="table-auto w-full border border-gray-300 bg-white shadow-lg rounded-lg">
    <thead>
      <tr class="bg-gray-200">
        <th class="px-4 py-2">Full Name</th>
        <th class="px-4 py-2">Phone</th>
        <th class="px-4 py-2">Email</th>
        <th class="px-4 py-2">Sex</th>
        <th class="px-4 py-2">Birthday</th>
        <th class="px-4 py-2">Timestamp</th>
        <th class="px-4 py-2">Actions</th>
      </tr>
    </thead>
    <tbody>
      <!-- Loop through users and display each user's data in a table row -->
      {% for user in users %}
      <tr>
        <td class="border px-4 py-2">{{ user.full_name }}</td>
        <td class="border px-4 py-2">{{ user.phone_number }}</td>
        <td class="border px-4 py-2">{{ user.email }}</td>
        <td class="border px-4 py-2">{{ user.sex }}</td>
        <td class="border px-4 py-2">{{ user.birthday }}</td>
        <td class="border px-4 py-2">{{ user.timestamp.strftime('%Y-%m-%d %H:%M:%S') if user.timestamp else '' }}</td>
        <td class="border px-4 py-2">
          <!-- Delete button: Submits a POST request to delete the user -->
          <form action="/delete/{{ user.id }}" method="post" onsubmit="return confirm('Are you sure you want to delete this user?');">
            <button type="submit" class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Success Modal: Shows if there is a success message from backend -->
  {% if message %}
    <div id="successModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50">
      <div class="bg-white rounded-lg shadow-lg p-6 w-80 text-center">
        <div class="text-green-600 text-lg font-semibold mb-2">Success</div>
        <div class="mb-4">{{ message }}</div>
        <button onclick="document.getElementById('successModal').style.display='none'" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Okay</button>
      </div>
    </div>
  {% endif %}
  <!-- Error Modal: Shows if there is an error message from backend -->
  {% if error %}
    <div id="errorModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50">
      <div class="bg-white rounded-lg shadow-lg p-6 w-80 text-center">
        <div class="text-red-600 text-lg font-semibold mb-2">Error</div>
        <div class="mb-4">{{ error }}</div>
        <button onclick="document.getElementById('errorModal').style.display='none'" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Okay</button>
      </div>
    </div>
  {% endif %}
</body>
</html>
